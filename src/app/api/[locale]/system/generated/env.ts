/**
 * AUTO-GENERATED FILE - DO NOT EDIT
 * Generated by Env Generator
 *
 * command: vibe generate:env
 */

import "server-only";

import { validateEnv } from "next-vibe/shared/utils/env-util";
import type { z } from "zod";

import { envValidationLogger } from "@/app/api/[locale]/system/unified-interface/shared/env/validation-logger";

// Import env modules
import { agentEnv, agentEnvSchema } from "../../agent/env";
import { emailEnv, emailEnvSchema } from "../../emails/env";
import {
  imapClientEnv,
  imapClientEnvSchema,
} from "../../emails/imap-client/env";
import {
  leadsCampaignsEnv,
  leadsCampaignsEnvSchema,
} from "../../leads/campaigns/env";
import { paymentEnv, paymentEnvSchema } from "../../payment/env";
import { smsEnv, smsEnvSchema } from "../../sms/env";
import { hostingEnv, hostingEnvSchema } from "../hosting/env";
import { serverSystemEnv, serverSystemEnvSchema } from "../server/env";
import { cliEnv, cliEnvSchema } from "../unified-interface/cli/env";

// Platform detection
const platform = {
  isServer: true,
  isReactNative: false,
  isBrowser: false,
};

// Module registry for introspection
export const envModules = {
  agent: { env: agentEnv, schema: agentEnvSchema },
  serverSystem: { env: serverSystemEnv, schema: serverSystemEnvSchema },
  cli: { env: cliEnv, schema: cliEnvSchema },
  hosting: { env: hostingEnv, schema: hostingEnvSchema },
  sms: { env: smsEnv, schema: smsEnvSchema },
  leadsCampaigns: { env: leadsCampaignsEnv, schema: leadsCampaignsEnvSchema },
  payment: { env: paymentEnv, schema: paymentEnvSchema },
  email: { env: emailEnv, schema: emailEnvSchema },
  imap: { env: imapClientEnv, schema: imapClientEnvSchema },
} as const;

// Combined schema using merge
export const envSchema = agentEnvSchema
  .merge(serverSystemEnvSchema)
  .merge(cliEnvSchema)
  .merge(hostingEnvSchema)
  .merge(smsEnvSchema)
  .merge(leadsCampaignsEnvSchema)
  .merge(paymentEnvSchema)
  .merge(emailEnvSchema)
  .merge(imapClientEnvSchema);

export type Env = z.infer<typeof envSchema>;

/**
 * Validate all environment variables
 * Call this explicitly at dev/build time
 */
export function validateAllEnv(): Env {
  return validateEnv(
    { ...process.env, platform },
    envSchema,
    envValidationLogger,
  );
}

/**
 * Validated environment variables (singleton)
 */
export const env: Env = validateAllEnv();

/**
 * Get a specific module's validated env vars from the singleton
 */
export function getModuleEnv<K extends keyof typeof envModules>(
  moduleName: K,
): (typeof envModules)[K]["env"] {
  return envModules[moduleName].env;
}

/**
 * Get list of all registered env modules
 */
export function getEnvModuleNames(): (keyof typeof envModules)[] {
  return Object.keys(envModules) as (keyof typeof envModules)[];
}
