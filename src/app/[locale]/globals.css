@import "tailwindcss";

@plugin 'tailwindcss-animate';

@custom-variant dark (&:where(html.dark, html.dark *));
@custom-variant light (&:where(html:not(.dark), html:not(.dark) *));

@theme {
  /* Container query breakpoints */
  --container-2xl: 48rem;
  --container-3xl: 56rem;

  /* Tailwind v4 uses color-mix() automatically for opacity modifiers */
  /* IMPORTANT: Expose final color values directly (no nested hsl(var(...)))
     so production minifiers don't mangle color-mix() with custom properties. */
  --color-background: hsl(var(--background));
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: hsl(var(--popover));
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: hsl(var(--primary));
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar-background);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);
}

/*
  The default border color has changed to `currentColor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentColor);
  }
}

@layer utilities {
  body {
    font-family: Arial, Helvetica, sans-serif;
  }

  /* STT wave animation for transcribing indicator */
  @keyframes wave {
    0%,
    100% {
      height: 12px;
    }
    50% {
      height: 24px;
    }
  }

  /* Custom scrollbar styles for all browsers */
  /* Firefox */
  * {
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--border)) transparent;
  }

  .dark * {
    scrollbar-color: hsl(var(--border)) transparent;
  }

  /* Webkit browsers (Chrome, Safari, Edge) */
  *::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 4px;
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  *::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--border) / 0.8);
    background-clip: padding-box;
  }

  .dark *::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
  }

  .dark *::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--border) / 0.8);
  }

  /* Ensure dropdown items are interactive */
  [data-radix-select-item]:not([data-disabled]) {
    pointer-events: auto;
    cursor: pointer;
  }

  [cmdk-item]:not([data-disabled]) {
    pointer-events: auto;
    cursor: pointer;
  }

  /* Fallback for gradient text when bg-clip-text fails */
  @supports not (-webkit-background-clip: text) {
    .bg-linear-to-br.from-cyan-500.to-blue-600.text-transparent.bg-clip-text {
      color: #2563eb !important;
      background: none !important;
      -webkit-text-fill-color: unset !important;
    }

    .bg-linear-to-br.from-red-600.to-orange-600.text-transparent.bg-clip-text {
      color: #dc2626 !important;
      background: none !important;
      -webkit-text-fill-color: unset !important;
    }

    .bg-linear-to-br.from-blue-600.to-cyan-600.text-transparent.bg-clip-text {
      color: #2563eb !important;
      background: none !important;
      -webkit-text-fill-color: unset !important;
    }
  }

  /* Additional fallback for when gradients don't render at all on Apple devices */
  @media screen and (-webkit-min-device-pixel-ratio: 0) {
    .bg-linear-to-br.from-cyan-500.to-blue-600.text-transparent.bg-clip-text {
      background: linear-gradient(to right, #06b6d4, #2563eb) !important;
      -webkit-background-clip: text !important;
      background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
    }

    .bg-linear-to-br.from-red-600.to-orange-600.text-transparent.bg-clip-text {
      background: linear-gradient(to right, #dc2626, #ea580c) !important;
      -webkit-background-clip: text !important;
      background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
    }

    .bg-linear-to-br.from-blue-600.to-cyan-600.text-transparent.bg-clip-text {
      background: linear-gradient(to right, #2563eb, #0891b2) !important;
      -webkit-background-clip: text !important;
      background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
    }

    /* Stronger fallback for button gradients on Apple devices */
    .bg-linear-to-br.from-cyan-500.to-blue-600:not(.text-transparent) {
      background: #2563eb !important;
      background-image: linear-gradient(to right, #06b6d4, #2563eb) !important;
    }

    .bg-linear-to-br.from-cyan-500.to-blue-600:not(.text-transparent):hover {
      background: #1d4ed8 !important;
      background-image: linear-gradient(to right, #0891b2, #1d4ed8) !important;
    }
  }

  /* Emergency fallback for invisible buttons on Apple devices */
  @supports not (background: linear-gradient(to right, #06b6d4, #2563eb)) {
    .bg-linear-to-br.from-cyan-500.to-blue-600:not(.text-transparent) {
      background-color: #2563eb !important;
      background-image: none !important;
    }

    .bg-linear-to-br.from-cyan-500.to-blue-600:not(.text-transparent):hover {
      background-color: #1d4ed8 !important;
      background-image: none !important;
    }
  }

  /* Fallbacks for older Chrome border colors */
  @supports not (border-color: hsl(var(--border))) {
    * {
      border-color: #e2e8f0 !important;
    }

    .dark * {
      border-color: #1e293b !important;
    }

    .border-gray-200 {
      border-color: #e5e7eb !important;
    }

    .border-gray-300 {
      border-color: #d1d5db !important;
    }

    .border-blue-200 {
      border-color: #dbeafe !important;
    }

    .border-blue-300 {
      border-color: #93c5fd !important;
    }

    .dark .border-gray-700 {
      border-color: #374151 !important;
    }

    .dark .border-gray-800 {
      border-color: #1f2937 !important;
    }

    /* Input and form element borders */
    input,
    textarea,
    select {
      border-color: #d1d5db !important;
    }

    .dark input,
    .dark textarea,
    .dark select {
      border-color: #374151 !important;
    }

    /* Button borders */
    button {
      border-color: transparent !important;
    }

    /* Card and container borders */
    .border {
      border-color: #e2e8f0 !important;
    }

    .dark .border {
      border-color: #1e293b !important;
    }
  }

  /* Additional fallback for very old Chrome versions */
  @media screen and (-webkit-min-device-pixel-ratio: 0) {
    @supports not (color: hsl(0 0% 0%)) {
      :root {
        --background: #d1dff5;
        --foreground: #0f172a;
        --border: #bfdbfe;
        --input: #bfdbfe;
        --ring: #3b82f6;
        --primary: #3b82f6;
        --primary-foreground: #f8fafc;
      }

      .dark {
        --background: #0c101c;
        --foreground: #f8fafc;
        --border: #1e293b;
        --input: #1e293b;
        --ring: #3b82f6;
        --primary: #3b82f6;
        --primary-foreground: #f8fafc;
      }
    }
  }
}

@layer base {
  :root {
    /* Fallbacks for older browsers */
    --background: #d1dff5;
    --foreground: #0f172a;
    --card: #dbeafe;
    --card-foreground: #0f172a;
    --popover: #dbeafe;
    --popover-foreground: #0f172a;
    --primary: #4f46e5;
    --primary-foreground: #f9fafb;
    --secondary: #e0e7ff;
    --secondary-foreground: #111827;
    --muted: #d5e0ff;
    --muted-foreground: #4b5563;
    --accent: #e5edff;
    --accent-foreground: #111827;
    --destructive: #ef4444;
    --destructive-foreground: #f9fafb;
    --border: #c7d2fe;
    --input: #c7d2fe;
    --ring: #4f46e5;

    /* Modern HSL values for newer browsers */
    --background: 216.7 64.3% 89%;
    --foreground: 230 35% 15%;
    --card: 222 70% 96%;
    --card-foreground: 230 35% 15%;
    --popover: 222 70% 96%;
    --popover-foreground: 230 35% 15%;
    --primary: 227 76% 57%;
    --primary-foreground: 0 0% 100%;
    --secondary: 222 60% 92%;
    --secondary-foreground: 230 30% 20%;
    --muted: 222 30% 88%;
    --muted-foreground: 228 20% 42%;
    --accent: 230 70% 92%;
    --accent-foreground: 233 45% 18%;
    --destructive: 0 75% 55%;
    --destructive-foreground: 0 0% 100%;
    --border: 222 45% 84%;
    --input: 222 45% 84%;
    --ring: 227 76% 57%;
    --chart-1: 227 76% 57%;
    --chart-2: 199 89% 55%;
    --chart-3: 268 84% 70%;
    --chart-4: 46 96% 65%;
    --chart-5: 340 80% 63%;
    --radius: 0.5rem;
    --sidebar-background: 222 65% 96%;
    --sidebar-foreground: 230 35% 18%;
    --sidebar-primary: 227 76% 57%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 222 58% 93%;
    --sidebar-accent-foreground: 230 35% 18%;
    --sidebar-border: 222 40% 86%;
    --sidebar-ring: 227 76% 57%;
  }

  .dark {
    /* Fallbacks for older browsers */
    --background: #0c101c;
    --foreground: #f9fafb;
    --card: #0f172a;
    --card-foreground: #f9fafb;
    --popover: #0f172a;
    --popover-foreground: #f9fafb;
    --primary: #6366f1;
    --primary-foreground: #f9fafb;
    --secondary: #111827;
    --secondary-foreground: #e5e7eb;
    --muted: #1f2937;
    --muted-foreground: #9ca3af;
    --accent: #111827;
    --accent-foreground: #e5e7eb;
    --destructive: #f97373;
    --destructive-foreground: #0b1120;
    --border: #1f2937;
    --input: #1f2937;
    --ring: #6366f1;

    /* Modern HSL values for newer browsers */
    --background: 225 40% 7.8%;
    --foreground: 210 40% 98%;
    --card: 225 35% 10%;
    --card-foreground: 210 40% 98%;
    --popover: 225 35% 10%;
    --popover-foreground: 210 40% 98%;
    --primary: 227 76% 62%;
    --primary-foreground: 210 40% 98%;
    --secondary: 225 28% 16%;
    --secondary-foreground: 210 40% 96%;
    --muted: 225 20% 22%;
    --muted-foreground: 215 18% 70%;
    --accent: 227 45% 28%;
    --accent-foreground: 210 40% 96%;
    --destructive: 0 72% 51%;
    --destructive-foreground: 210 40% 98%;
    --border: 225 22% 24%;
    --input: 225 22% 24%;
    --ring: 227 76% 62%;
    --chart-1: 227 76% 62%;
    --chart-2: 199 89% 55%;
    --chart-3: 268 84% 70%;
    --chart-4: 46 96% 65%;
    --chart-5: 340 80% 63%;
    --sidebar-background: 225 40% 6%;
    --sidebar-foreground: 210 40% 96%;
    --sidebar-primary: 227 76% 62%;
    --sidebar-primary-foreground: 210 40% 98%;
    --sidebar-accent: 225 28% 16%;
    --sidebar-accent-foreground: 210 40% 96%;
    --sidebar-border: 225 22% 22%;
    --sidebar-ring: 227 76% 62%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
  }

  .container {
    @apply mx-auto px-4 md:px-6;
  }

  /* Fix for cut-off bottoms of letters */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply leading-tight tracking-tight;
  }

  p {
    @apply leading-relaxed;
  }
}

html {
  scroll-behavior: smooth;
  scroll-padding-top: 4rem;
  /* Default for smaller screens (64px) */
}

@media (min-width: 768px) {
  /* Tailwind's md breakpoint */
  html {
    scroll-padding-top: 5rem;
    /* For md and above (80px) */
  }
}

/* Additional typography improvements */
.text-balance {
  text-wrap: balance;
}

/* Fix for button text alignment */
button,
.button {
  line-height: 1.5;
}

/* Improve form elements */
input,
select,
textarea {
  line-height: 1.5;
}

.container {
  margin: 0 auto;
}
